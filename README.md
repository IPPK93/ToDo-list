# ToDo list

## Введение

Проект состоит из нескольких частей:

- `app` - модуль с приложением;
		
		- `templates` - `html`-шаблоны;
		
		- `logged_tasks_handler` - файл с логгирующим обработчиком поступающих таск;
		
		- `page_indexer` - вспомогательный модуль для удобного подсчёта индексов для пагинации;
		
		- `task` - класс для задачи;
		
		- `views` - модуль, в котором прописано взаимодействие клиента с сервером;
- `tests` - тесты.

Также содержатся файлы для менеджинга зависимостей (посредством `poetry`) и `makefile` для удобной работы с программой.

## Запуск

Для запуска в командной строке в директории с проектом нужно набрать

```
make up
```

## Требования

Для корректной подгрузки зависимостей нужен `poetry`, все зависимости находятся в `pyproject.toml`. 
Для работы с `makefile` использовался `cygwin`, но должна подойти и любая другая программа, которая умеет работать с `make`.

При наличии `poetry` и поддержки `make` алгоритм действий следующий:

1) Создаём виртуальное окружение:

```
make venv
```

2) Проверяем корректность программы:

```
make check
```

3) Запускаем так:

```
make up
```


## Дополнительно

В коде могут встретиться следующие странности:

```
# pylint: disable=wrong-import-position

from app.views import tasks  # noqa: E402 F401

# pylint: enable=wrong-import-position
```

Это сделано для того, чтобы линтеры не ругались на вставку импорта не в начало. К сожалению, единственное решение, которое получилось найти (<a href="https://stackoverflow.com/questions/64623869/pylint-import-import-routes-should-be-placed-at-the-top-of-the-module">ссылка</a>).

Кроме того, в `views.py` можно заметить, например, такую интересность:

```
@app.app.route('/')  # type: ignore
```

Эти `type: ignore` связаны с тем, что `mypy` очень не хочет определять тип `app`. Насколько мы поняли, проблема встречается не только у нас(<a href="https://github.com/python/mypy/issues/7552">1</a>, <a href="https://github.com/python/mypy/issues/1503">2</a>). 

В `LoggedTasksHandler` можно увидеть следующее:

```
    @TasksHandler.status.setter  # type: ignore[attr-defined]
```

Как оказалось, `mypy` не очень хорошо обрабатывает `property` в случае наследования только сеттера (<a href="https://github.com/python/mypy/issues/5936">ссылка</a>).

Программа покрыта тестами на 99%, для тестирования использовался `pytest`. 
Прохождение всех линтеров и тестов (`make check`) проверялось на `Windows`.

---
Спасибо за прочтение!